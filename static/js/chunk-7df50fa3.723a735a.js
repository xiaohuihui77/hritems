(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7df50fa3"],{"01f5":function(e,t,a){"use strict";t["a"]={hireType:[{id:1,value:"正式"},{id:2,value:"非正式"}],subjection:[{id:"1",value:"总部"},{id:"2",value:"分城市"}],workingState:[{id:"1",value:"在职"},{id:"2",value:"离职"}],leaveType:[{id:"1",value:"主动离职"},{id:"2",value:"被动离职"},{id:"3",value:"退休"}],attritionMonth:[{id:"1",value:"离职日本月"},{id:"2",value:"离职日次月"}],informaltype:[{id:"2",value:"实习"},{id:"3",value:"劳务"},{id:"4",value:"顾问"},{id:"5",value:"返聘"},{id:"6",value:"外包"}],highestDegree:[{id:"1",value:"初中"},{id:"2",value:"高中"},{id:"3",value:"中专"},{id:"4",value:"大专"},{id:"5",value:"本科"},{id:"6",value:"硕士"},{id:"7",value:"博士"},{id:"8",value:"其他"}],isOverseas:[{id:"1",value:"中国大陆"},{id:"2",value:"港澳台国外"}],gender:[{id:"1",value:"男"},{id:"2",value:"女"}],maritaStatus:[{id:"1",value:"未婚"},{id:"2",value:"已婚"},{id:"3",value:"离异"}],animalSymbol:[{id:"1",value:"鼠"},{id:"2",value:"牛"},{id:"3",value:"虎"},{id:"4",value:"兔"},{id:"5",value:"龙"},{id:"6",value:"蛇"},{id:"7",value:"马"},{id:"8",value:"羊"},{id:"9",value:"猴"},{id:"10",value:"鸡"},{id:"11",value:"狗"},{id:"12",value:"猪"}],constellation:[{code:1,value:"水瓶座"},{code:2,value:"双鱼座"},{code:3,value:"白羊座"},{code:4,value:"金牛座"},{code:5,value:"双子座"},{code:6,value:"巨蟹座"},{code:7,value:"狮子座"},{code:8,value:"处女座"},{code:9,value:"天秤座"},{code:10,value:"天蝎座"},{code:11,value:"射手座"},{code:12,value:"摩羯座"}],bloodType:[{id:"1",value:"A型"},{id:"2",value:"B型"},{id:"3",value:"O型"},{id:"4",value:"AB型"}],educationType:[{id:"1",value:"统招"},{id:"2",value:"自考"},{id:"3",value:"成考"}],positiveType:[{id:"1",value:"已转正"},{id:"2",value:"未转正"}],contractPeriod:[{id:"1",value:"6月"},{id:"2",value:"12月"},{id:"3",value:"24月"},{id:"4",value:"36月"},{id:"5",value:"其他"}],renewalCount:[{id:1,value:"0次"},{id:2,value:"1次"},{id:3,value:"2次"},{id:4,value:"3次"},{id:5,value:"4次或以上"}],resumeSource:[{id:"1",value:"智联招聘"},{id:"2",value:"拉勾网"},{id:"3",value:"前程无忧"},{id:"4",value:"猎聘网"},{id:"5",value:"校园宣讲"},{id:"6",value:"猎头"},{id:"7",value:"内部推荐"}],hireSourceType:[{id:"1",value:"社招"},{id:"2",value:"校招"}],departments:[{id:"1",value:"总裁办"},{id:"2",value:"研究院"}],stausInfos:[{id:"1",value:"在职"},{id:"2",value:"入职"},{id:"3",value:"离职"}]}},"0b62":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container"},[a("div",{staticClass:"app-container"},[a("page-tools",{attrs:{"show-before":!0}},[a("span",{attrs:{slot:"before"},slot:"before"},[e._v("共"+e._s(e.total)+"条记录")]),a("template",{slot:"after"},[a("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(t){return e.$router.push({name:"Import"})}}},[e._v("导入")]),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.exportData}},[e._v("导出")]),e.checkPermission("add-user")?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addU}},[e._v("新增员工")]):e._e()],1)],2),a("el-card",[a("el-table",{attrs:{border:"",data:e.userList}},[a("el-table-column",{attrs:{type:"index",label:"序号",sortable:""}}),a("el-table-column",{attrs:{prop:"username",label:"姓名",sortable:""}}),a("el-table-column",{attrs:{label:"头像",width:"101px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-image",{staticStyle:{width:"80px",height:"80px"},attrs:{src:r.staffPhoto.trim()?r.staffPhoto:"#",fit:"fill"},on:{click:function(t){e.clickShowMa(r.staffPhoto.trim())}}},[a("template",{slot:"error"},[a("img",{staticStyle:{width:"80px",height:"80px"},attrs:{src:"http://hrsaas-1312603163.cos.ap-chongqing.myqcloud.com/%E5%B0%8F%E7%81%B0%E7%81%B0.png"},on:{click:function(t){e.clickShowMa(r.staffPhoto.trim())}}})])],2)]}}])}),a("el-table-column",{attrs:{prop:"workNumber",label:"工号",sortable:""}}),a("el-table-column",{attrs:{prop:"formOfEmployment",label:"聘用形式",formatter:e.formatEmployment,sortable:""}}),a("el-table-column",{attrs:{prop:"departmentName",label:"部门",sortable:""}}),a("el-table-column",{attrs:{label:"入职时间",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDate")(t.row.timeOfEntry)))])]}}])}),a("el-table-column",{attrs:{prop:"enableState",label:"账户状态",sortable:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-switch",{attrs:{value:1===t.enableState}})]}}])}),a("el-table-column",{attrs:{label:"操作",sortable:"",fixed:"right",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.$router.push({path:"/employees/detail/"+r.id})}}},[e._v("查看")]),a("el-button",{attrs:{type:"text",size:"small"}},[e._v("转正")]),a("el-button",{attrs:{type:"text",size:"small"}},[e._v("调岗")]),a("el-button",{attrs:{type:"text",size:"small"}},[e._v("离职")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRole(r.id)}}},[e._v("角色")]),e.checkPermission("point-user-delete")?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.delUser(r.id)}}},[e._v("删除")]):e._e()]}}])})],1),a("el-row",{staticStyle:{height:"60px"},attrs:{type:"flex",justify:"center",align:"middle"}},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{layout:"prev, pager, next",total:e.total,"current-page":e.page,"page-size":e.pageSize},on:{"current-change":e.pageChange}})],1)])],1)],1),a("add-employee",{attrs:{"show-dialog":e.showDialog},on:{"update:showDialog":function(t){e.showDialog=t},"update:show-dialog":function(t){e.showDialog=t},cancel:e.cancel,confirm:e.confirm}}),a("el-dialog",{attrs:{title:"头像 && 二维码",visible:e.showMa},on:{"update:visible":function(t){e.showMa=t}}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"12",type:"flex"}},[a("img",{staticStyle:{width:"170px",height:"170px"},attrs:{src:e.iconUrl,alt:"#"}})]),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:"12"}},[a("canvas",{ref:"qrcode"})])],1)],1),a("assign-role",{ref:"assignRole",attrs:{"show-role-dialog":e.showRoleDialog,"user-id":e.userId},on:{"update:showRoleDialog":function(t){e.showRoleDialog=t},"update:show-role-dialog":function(t){e.showRoleDialog=t}}})],1)},l=[],o=a("c7eb"),n=a("1da1"),i=(a("7db0"),a("d3b7"),a("3ca3"),a("ddb0"),a("b64b"),a("d81d"),a("c24f")),s=a("01f5"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新增员工",visible:e.showDialog,"before-close":e.cancel,"close-on-click-modal":!1},on:{close:e.close},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("确定")])],1)],1)]},proxy:!0}])},[a("el-form",{ref:"ruleForm",attrs:{model:e.formData,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"username"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"请输入姓名"},model:{value:e.formData.username,callback:function(t){e.$set(e.formData,"username",t)},expression:"formData.username"}})],1),a("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"请输入手机号"},model:{value:e.formData.mobile,callback:function(t){e.$set(e.formData,"mobile",t)},expression:"formData.mobile"}})],1),a("el-form-item",{attrs:{label:"入职时间",prop:"timeOfEntry"}},[a("el-date-picker",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择日期"},model:{value:e.formData.timeOfEntry,callback:function(t){e.$set(e.formData,"timeOfEntry",t)},expression:"formData.timeOfEntry"}})],1),a("el-form-item",{attrs:{label:"聘用形式",prop:"formOfEmployment"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择"},model:{value:e.formData.formOfEmployment,callback:function(t){e.$set(e.formData,"formOfEmployment",t)},expression:"formData.formOfEmployment"}},[a("el-option",{attrs:{label:"正式",value:"1"}}),a("el-option",{attrs:{label:"非正式",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"工号",prop:"workNumber"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"请输入工号"},model:{value:e.formData.workNumber,callback:function(t){e.$set(e.formData,"workNumber",t)},expression:"formData.workNumber"}})],1),a("el-form-item",{staticClass:"department",attrs:{label:"部门",prop:"departmentName"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{readonly:"",placeholder:"请选择部门"},on:{focus:e.focus,blur:e.blur},model:{value:e.formData.departmentName,callback:function(t){e.$set(e.formData,"departmentName",t)},expression:"formData.departmentName"}}),a("el-tree",{staticClass:"tree",class:{showTree:!e.showTree},attrs:{data:e.departs,"default-expand-all":"",props:e.defaultProps,"expand-on-click-node":!1,"highlight-current":!0},on:{"node-click":e.handleNodeClick}})],1),a("el-form-item",{attrs:{label:"转正时间",prop:"correctionTime"}},[a("el-date-picker",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择日期"},model:{value:e.formData.correctionTime,callback:function(t){e.$set(e.formData,"correctionTime",t)},expression:"formData.correctionTime"}})],1)],1)],1)},u=[],d=a("5530"),m=(a("4de4"),a("b0c0"),a("1eef")),f={props:{showDialog:{type:Boolean,default:!1}},data:function(){return{showTree:!1,departs:[],departmentName:"",isBlur:!1,defaultProps:{label:"name"},formData:{username:"",mobile:"",formOfEmployment:"",workNumber:"",departmentName:"",timeOfEntry:"",correctionTime:""},rules:{username:[{required:!0,message:"请输入姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],formOfEmployment:[{required:!0,message:"请选择聘用形式",trigger:"blur"}],workNumber:[{required:!0,message:"请输入工号",trigger:"blur"},{pattern:/^\d+$/,message:"请输入数字类型工号",trigger:"blur"}],departmentName:[{required:!0,message:"请选择部门",trigger:"change"}],timeOfEntry:[{required:!0,message:"请选择入职时间",trigger:"blur"}],correctionTime:[{required:!0,message:"请选择转正时间",trigger:"blur"}]}}},methods:{getDepartmentAll:function(){var e=this;return Object(n["a"])(Object(o["a"])().mark((function t(){var a,r;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(m["c"])();case 3:a=t.sent,r=a.data,e.departs=e.findChild(r.depts),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$message.error(t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},findChild:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.filter((function(e){return e.pid===a})).map((function(a){return Object(d["a"])(Object(d["a"])({},a),{},{children:t.findChild(e,a.id)})}))},close:function(){this.formData={username:"",mobile:"",formOfEmployment:"",workNumber:"",departmentName:"",timeOfEntry:"",correctionTime:""},this.departs=[],this.$refs.ruleForm.resetFields()},cancel:function(){this.$emit("cancel")},confirm:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;e.$emit("confirm",e.formData)}))},focus:function(){this.showTree=!0,this.getDepartmentAll()},handleNodeClick:function(e){this.formData.departmentName=e.name,this.showTree=!1},blur:function(){var e=this;setTimeout((function(){e.showTree&&(e.showTree=!1)}),140)}}},p=f,h=(a("b634"),a("2877")),b=Object(h["a"])(p,c,u,!1,null,"ace9c896",null),v=b.exports,g=a("5a0c"),w=a.n(g),y=a("d055"),k=a.n(y),x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"分配角色",visible:e.showRoleDialog,"before-close":e.cancel}},[a("el-checkbox-group",{model:{value:e.roleIds,callback:function(t){e.roleIds=t},expression:"roleIds"}},e._l(e.list,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1),a("el-row",{attrs:{slot:"footer",type:"flex",justify:"center"},slot:"footer"},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("确定")]),a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},O=[],D=a("90e7"),j={props:{showRoleDialog:{type:Boolean,default:!1},userId:{type:String,default:null}},data:function(){return{list:[],roleIds:[]}},created:function(){this.getRoleList()},methods:{getRoleList:function(){var e=this;return Object(n["a"])(Object(o["a"])().mark((function t(){var a,r;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(D["b"])();case 2:a=t.sent,r=a.data,e.list=r.rows;case 5:case"end":return t.stop()}}),t)})))()},getUserDetailById:function(e){var t=this;return Object(n["a"])(Object(o["a"])().mark((function a(){var r,l;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["i"])(e);case 2:r=a.sent,l=r.data,t.roleIds=l.roleIds;case 5:case"end":return a.stop()}}),a)})))()},confirm:function(){var e=this;return Object(n["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["b"])({id:e.userId,roleIds:e.roleIds});case 2:e.$emit("update:showRoleDialog",!1);case 3:case"end":return t.stop()}}),t)})))()},cancel:function(){this.roleIds=[],this.$emit("update:showRoleDialog",!1)}}},_=j,S=Object(h["a"])(_,x,O,!1,null,null,null),E=S.exports,$={components:{AddEmployee:v,AssignRole:E},data:function(){return{userList:[],total:0,page:1,pageSize:10,showDialog:!1,showMa:!1,iconUrl:"#",showRoleDialog:!1,userId:null}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this;Object(i["j"])({page:this.page,size:this.pageSize}).then((function(t){e.userList=t.data.rows,e.total=t.data.total}))},pageChange:function(e){this.page=e,this.getUserList()},formatEmployment:function(e,t,a,r){var l=s["a"].hireType.find((function(e){return e.id===+a}));return l?l.value:"未知"},delUser:function(e){var t=this;Object(i["c"])(e).then((function(e){t.getUserList(),t.$message.success(e.message)}))},addU:function(){this.showDialog=!0},cancel:function(){this.showDialog=!1},confirm:function(e){var t=this;Object(i["a"])(e).then((function(e){t.showDialog=!1,t.getUserList(),t.$message.success(e.message)}))},exportData:function(){var e=this,t={"姓名":"username","手机号":"mobile","入职日期":"timeOfEntry","聘用形式":"formOfEmployment","转正日期":"correctionTime","工号":"workNumber","部门":"departmentName"};Promise.all([a.e("chunk-a58ca3c4"),a.e("chunk-2d0cc0b6")]).then(a.bind(null,"4bf8")).then(function(){var a=Object(n["a"])(Object(o["a"])().mark((function a(r){var l,n;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["j"])({page:1,size:e.total});case 2:l=a.sent,n=e.formatJson(t,l.data.rows),r.export_json_to_excel({header:Object.keys(t),data:n,filename:"员工列表",autoWidth:!0,bookType:"xlsx",multiHeader:[["姓名","主要信息","","","","","部门"]],merges:["A1:A2","B1:F1","G1:G2"]});case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},formatJson:function(e,t){return t.map((function(t){return Object.keys(e).map((function(a){return"timeOfEntry"===e[a]||"correctionTime"===e[a]?w()(t[e[a]]).format("YYYY/MM/DD"):"formOfEmployment"===e[a]?1===+t[e[a]]?"正式":2===+t[e[a]]?"非正式":"未知":t[e[a]]}))}))},clickShowMa:function(e){var t=this;e?(this.showMa=!0,this.iconUrl=e,this.$nextTick((function(){k.a.toCanvas(t.$refs.qrcode,e)}))):this.$message("该用户尚未上传头像，当前为默认头像")},editRole:function(e){var t=this;return Object(n["a"])(Object(o["a"])().mark((function a(){return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.userId=e,a.next=3,t.$refs.assignRole.getUserDetailById(e);case 3:t.showRoleDialog=!0;case 4:case"end":return a.stop()}}),a)})))()}}},T=$,N=Object(h["a"])(T,r,l,!1,null,null,null);t["default"]=N.exports},"1eef":function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return n})),a.d(t,"d",(function(){return i}));var r=a("b775");function l(){return Object(r["a"])({url:"/company/department",method:"get"})}var o=function(e){return Object(r["a"])({url:"/company/department/"+e,method:"delete"})},n=function(e){return Object(r["a"])({url:"/company/department",method:"post",data:e})},i=function(e,t){return Object(r["a"])({url:"/company/department/"+e,method:"put",data:t})}},"90e7":function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return o}));var r=a("b775");function l(e){return Object(r["a"])({url:"/sys/role",params:e})}function o(e){return Object(r["a"])({url:"/sys/role/assignPrem",method:"put",data:e})}},b634:function(e,t,a){"use strict";a("ff80")},ff80:function(e,t,a){}}]);